<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<title>Igor-slacker blog
</title>
<meta name="description" content="Igor-slacker blog
">
<meta name="keywords" content="GameMaker, Программирование">

<meta property="og:type" content="article">
<meta property="og:title" content="The Game Maker Language: введение, выражения &#8211; ">
<meta property="og:description" content="Igor-slacker blog
">
<meta property="og:url" content="http://localhost:4000/2013/06/08/gml-intro.html">
<meta property="og:site_name" content="">

<!-- Webmaster Tools verfication -->




<link rel="canonical" href="http://localhost:4000/2013/06/08/gml-intro.html">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">

<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="stylesheet" href=" /css/main.min.css" type="text/css" />
</head>
<body>
  <div class="header-container">
  <header>
      <ul class="nav">
        <!--Change the  URL here if working on an absolute domain-->
        <li><a href="http://localhost:4000"><span class="mega-octicon octicon-terminal" style="margin-right: 6px;"></span>Home</a></li>
        <li><a href="http://localhost:4000/about"><span class="mega-octicon octicon-person" style="margin-right: 6px;"></span>About</a></li>
      </ul>
  </header>
</div>

  <div class="container">
  <h2>The Game Maker Language: введение, выражения</h2>
<p class="meta">08 Jun 2013</p>

<div class="post">
<p>Изначально создававшийся для создания анимации Марком Овермарсом, GameMaker перерос в целый игровой движок, способный работать на целом ряде платформ, и сейчас поддерживается целой организацией опытных разработчиков YoYo Games. Когда-то Game Maker, ныне GameMaker. Сейчас среди всех доступных средств для разработки его можно отнести к “игровым конструкторам общего назначения”.</p>

<p>Он не ограничивает вас конкретным жанром игры. Чем это плохо? Почти всю игровую механику вам придётся вписывать самостоятельно.  Зато написать на фоне всей этой дребедени что-то своё, чего никто раньше не делал, вы сможете без труда. Особенно это занятие облегчает наличие встроенного скриптового языка. На самом деле, без этого языка многое сделать либо просто нереально, либо слишком долго.</p>

<p><strong>Перед тем, как мы начнём…</strong>
Если вы хотите научиться пользоваться GameMaker с нуля - вы попали не по адресу. Учить GML имеет смысл только после освоения всего интерфейса, и хотя бы прочтения справки по действиям. Написать несколько игр (не серьёзных, разминочных) на нём тоже желательно, просто чтобы свыкнуться с основными принципами. В общем, в рамках этого цикла я буду считать, что вы знаете о каждом виде ресурсов в GameMaker (а именно спрайтах, комнатах и объектах - остальное можно разобрать и далее), а также умеете писать несложные действия с событиями. То есть, по сути, знаете всё, кроме языка. Или представляете, как это работает.</p>

<p>Всё ещё с нами? <strong>Хорошо, поехали!</strong></p>

<h3 id="Переменные">Переменные</h3>

<p>Почти все скрипты вертятся вокруг “переменных”. Переменная - некая информация, хранящаяся в известном месте. Для компьютера это адрес в оперативной памяти, а для вас - это имя переменной. Есть ряд системных переменных, но для написания сложных программ вам придётся использовать немало собственных. И придумывать им имена нужно с умом.</p>

<p>Не рекомендую использовать в них ничего, кроме латинских букв и знака _. Даже цифры. Их можно использовать лишь с тем условием, что название начинается не с цифры. Ещё стоит отметить, что “Vari” и “vari” - разные названия. Дальнейшие правила, которых я советую придерживаться, я расскажу позже - когда будем обсуждать написание скриптов.</p>

<p>А, и вот ещё. GML нещадно карает за любые опечатки. Пишите внимательно.</p>

<p>В GML значения у переменных могут быть всего двух типов (иначе говоря, в GML два типа данных). Это числа и текст. Если вы используете переменную, у которой значения ещё нет, а потому и тип её значения неизвестен - высветится ошибка. Это примерно как диалог:</p>

<p>— Дай мне авокадо!</p>

<p>— А что такое авокадо?</p>

<p><small>PS: да, наверное, меня можно назвать гурманом.</small></p>

<p>Также есть три типа видимости переменных: локальные, поля и глобальные. О том, как их создавать - позже, сейчас лишь различия:</p>

<ul>
  <li>
    <p>Локальные исчезают сразу после того, как закончился кусок кода с их участием. Нужно специально указать в начале участка кода, что переменная локальна. Они нужны лишь тогда, когда хранение числа нужно лишь в данном участке.</p>
  </li>
  <li>
    <p>Поля принадлежат объектам, и в каждом объекте свой экземпляр поля, со своим значением. Можете хранить в объектах что угодно при помощи полей. Этот тип видимости используется всегда, если не указано иное, также есть целый ряд подобных переменных в самом GM, в каждом объекте. Вполне очевидно, что каждый объект знает, где он находится, куда движется и с какой скоростью. А знания эти находятся в этих переменных: <code class="highlighter-rouge">x</code> <code class="highlighter-rouge">y</code> <code class="highlighter-rouge">speed</code> <code class="highlighter-rouge">direction</code>.
На самом деле, таких переменных гораздо больше, но сейчас нам это не понадобится. Если вы забыли какое-то название - подсмотрите в справке, потому что их такое огромное количество, что их бесполезно учить наизусть. Кое-что вы запомните сами в процессе работы, и этого вам, скорее всего, будет хватать.</p>
  </li>
  <li>
    <p>Глобальные доступны абсолютно всем абсолютно отовсюду. Из какого объекта вы бы к ней не обратились, вы получите одно и то же значение. В самом GM таких переменных тонна, и они описывают текущее состояние всей игры. К примеру, в <code class="highlighter-rouge">room</code> находится индекс работающей на данный момент комнаты, <code class="highlighter-rouge">room_speed</code> содержит число шагов, выполняемых игрой в секунду (это число обычно <code class="highlighter-rouge">30</code>, и указывается в настройках конкретной комнаты). Очевидно, в каждый конкретный момент эти характеристики одинаковы для всех.</p>
  </li>
</ul>

<h3 id="Выражения">Выражения</h3>

<p>Выражения - это любые конструкции GML, выполнение которых оставляет после себя некоторое значение. Простейший пример: <code class="highlighter-rouge">2+2</code>, вычисление этого выражения даст результат <code class="highlighter-rouge">4</code>. Что-нибудь посложнее: <code class="highlighter-rouge">2+2*2</code>. Это 6 (обращаю внимание, не <code class="highlighter-rouge">8</code>!). Если GM встречает выражение в коде, он вычисляет его, и на место всего выражения, проще говоря, подставляет получившийся результат. Это никак не влияет на последующие попытки выполнить код - выражение вычисляется каждый раз, когда выполняется фрагмент кода, в котором оно находится. Сложновато звучит, но работает очень просто - программа ничего не запоминает без вашего указания, и даже одинаковые вещи будет считать раз за разом, если приказано.</p>

<p>В этом посте мы будем рассматривать только простейшие выражения - будем трогать только числа и знаки <code class="highlighter-rouge">+</code> и <code class="highlighter-rouge">-</code>. В следующем посте, когда узнаем о функциях, сможем конструировать более крутые и полезные выражения.</p>

<p>Одно замечание. <strong>Не надо делить на ноль.</strong> Это плохо.</p>

<p>Может показаться странным - но писать код на GML мы начнём не со скриптов. Прежде чем писать какие-то действия, надо научиться обрабатывать данные из переменных. Поэтому наши первые фрагменты GML будут выражениями, и будут попадать в места, где, казалось бы, коду не место. Потому что выражение само по себе никак не влияет на игру.</p>

<p>Есть ещё один способ использовать выражения - режим отладки. В левом верхнем углу GameMaker у вас есть две кнопочки, а в строке меню есть <code class="highlighter-rouge">Run</code>.</p>

<p><img src="http://docs.yoyogames.com/source/dadiospice/000_using%20gamemaker/drop%20down%20menus/run_menu_image.png" alt="" /></p>

<p>Что делает первая опция, вы уже наверняка знаете, а что делает вторая - скорее всего, не поняли, если наугад попробовали. Она запускает игру в режиме отладки, и особенность этого режима - наличие окна с таблицей в два столбца. Первый столбец вы можете заполнять выражениями, второй столбец будет заполняться их значениями каждый шаг.</p>

<p><img src="http://docs.yoyogames.com/source/dadiospice/images/form_debug.png" alt="" /></p>

<p>Удобный способ следить за происходящим. Как с помощью этого режима следить за объектами - обсудим позднее, когда будем думать о применении объектов внутри скриптов.</p>

<p>Если вы работали с GM, то уже наверняка знаете о действии “прыжок в указанные координаты” или “jump to given position”. Он будет нашим подопытным, поскольку в него можно прекрасно вписывать любые числовые выражения. Напомню, это действие мгновенно перемещает объект в указанную точку.</p>

<p>В GameMaker: Studio это действие называется просто “Jump to position”, и выглядит так: <img src="http://docs.yoyogames.com/source/dadiospice/images/move_point.png" alt="" /></p>

<p>Окно нашего подопытного устроено просто. Два поля для координат нужной точки, и галочка “Relative” (“Относительно”) внизу, а также переключатель “кому совершить действие” в верхней части. Наш первый эксперимент будет объяснять, как работает галочка “Relative”. Возможно, вы это уже знаете, но на ценность урока это не повлияет.</p>

<p>Одна из самых распространённых задач, которые решают начинающие - сделать движение персонажа. И сейчас всё меньше статей, которые делают это без кода. По большей части потому, что их авторам лень тратить время на сооружение пугающих конструкций из значков, когда это можно записать в две строчки. То, что обучающийся ни слова не поймёт из скрипта, для них неважно или неочевидно.</p>

<p>Немножко математики. Каждая точка в комнате обладает некоторыми координатами вдоль двух осей: <code class="highlighter-rouge">x</code> и <code class="highlighter-rouge">y</code>, измеряются они в пикселях. В каждом объекте есть эти переменные, и они содержат его положение в комнате. Ось Х направлена вправо, то есть, при увеличении <code class="highlighter-rouge">х</code> объект сместится вправо, а при уменьшении влево. Ось Y же направлена вниз (не так, как принято на математических чертежах!) и увеличение <code class="highlighter-rouge">y</code> сместит объект вниз (уменьшение, соответственно, вверх). Точка, где x=0 и y=0 - левый верхний угол комнаты. Если изменять эти координаты каждый шаг на одну и ту же величину, объект будет двигаться с постоянной скоростью.</p>

<h3 id="Эксперимент-i">Эксперимент I</h3>

<p>Шаги, отмеченные флагом <span class="label label-info">Опционально</span> необязательны. Если вы понимаете, что произойдёт, выполнять их не нужно.</p>

<p><strong>Приготовления:</strong></p>

<ul>
  <li>Создайте в GM новую пустую игру.</li>
  <li>Создайте комнату (просто комнату, пустую, без всего).</li>
  <li>Создайте один спрайт, загрузите в него что-нибудь небольшое, три экземпляра чего поместятся на экран.</li>
  <li>Создайте три объекта: пусть даже <code class="highlighter-rouge">object0</code>, <code class="highlighter-rouge">object1</code> и (Опционально) <code class="highlighter-rouge">object2</code></li>
  <li>Укажите им всем ваш единственный спрайт.</li>
  <li>Разместите по одному экземпляру каждого объекта в вашей комнате.</li>
  <li>Создайте в <code class="highlighter-rouge">object0</code> и <code class="highlighter-rouge">object1</code> событие “Стрелка вправо” из группы “Клавиатура”: <img src="http://docs.yoyogames.com/source/dadiospice/images/event_keyboard.png" alt="" /></li>
  <li><span class="label label-info">Опционально</span> Своим любимым способом заставьте <code class="highlighter-rouge">object2</code> двигаться вправо со скоростью 1, когда нажата клавиша “вправо” (иначе стоять на месте).</li>
</ul>

<p><strong>Начинаем развлекаться!</strong></p>

<p>Теперь содержательная часть. В указанное событие вставьте действие, которое мы обсуждали выше (Jump to position), со следующими параметрами:</p>

<ul>
  <li>В <code class="highlighter-rouge">object0</code> поставьте галочку Relative, в поле “х” напишите <code class="highlighter-rouge">1</code>, в поле “y” оставьте <code class="highlighter-rouge">0</code>.</li>
  <li>В <code class="highlighter-rouge">object1</code> не ставьте Relative, в поле “х” напишите <code class="highlighter-rouge">x+1</code>, в поле “y” оставьте ноль.</li>
</ul>

<p>Запустите. Поймите, что происходит.</p>

<p>Очевидно, <code class="highlighter-rouge">x+1</code> - выражение. Оно может быть и более сложным. Скажем, оно может зависеть от ширины комнаты: <code class="highlighter-rouge">x+room_width/180</code>. Здесь <code class="highlighter-rouge">room_width</code> - системная переменная, и она есть в справке, как и все прочие. В таком варианте - за 180 шагов к <code class="highlighter-rouge">x</code> прибавится 180 раз наша дробь, то есть, прибавится ширина комнаты. А это означает, что объект сместится вправо на ширину комнаты за 6 секунд (<code class="highlighter-rouge">180/30</code>). Если он стоит у левого края в самом начале, то при непрерывном удерживании клавиши “вправо” 6 секунд он уйдёт за правую границу. Чтобы увидеть эффект такого выражения, позапускайте игру с разной шириной комнаты.</p>

<p>На этом обсуждение простейших выражений, а вместе с ним и первый урок завершается. В следующем уроке поговорим уже о функциях и действиях, что позволит уже писать простейшие скрипты! На этом знакомство с GML ещё только начинается. По плану нам нужно освоить:</p>

<ul>
  <li>функции</li>
  <li>сложные выражения</li>
  <li>действия</li>
  <li>простейшие скрипты</li>
  <li>языковые конструкции</li>
  <li>обращение к объектам</li>
  <li>управление ресурсами игры</li>
</ul>

<p>Программа большая. Надеюсь, успею довести её до логического конца и не сдуться по дороге.
Комментарии и вопросы по изложенному и будущему материалу всегда приветствуются!</p>

<p><strong>Не переключайтесь!</strong></p>

</div>



  

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', '']);
  _gaq.push(['_trackPageview']);
  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </div><!-- /.main -->
</body>
</html>